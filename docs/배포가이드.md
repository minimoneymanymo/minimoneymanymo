# ë°°í¬ ê°€ì´ë“œ

- Java í”„ë¡œì íŠ¸ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œ ë¹Œë“œí™˜ê²½ì„ ìœ„í•´ ë¯¸ë¦¬ Databaseì™€ ë„¤íŠ¸ì›Œí¬ í™˜ê²½êµ¬ì„±ì´ í•„ìš”í•©ë‹ˆë‹¤.
- main-net(ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ìƒì„±ì‹œ composeíŒŒì¼ ìˆ˜ì • í•„ìˆ˜)network ìƒì„± ì´í›„ compose í´ë”ì˜ nginx, postges, redis ìˆœì„œë¡œ ë³¸ì¸ì˜ ê°œì¸ ì„¤ì •ì„ ì ìš© í›„ docker-composeì‹¤í–‰
- Mainì„ Pullë°›ì€ ì´í›„ 3ê°œì˜ ë¦¬ì•¡íŠ¸, ìŠ¤í”„ë§, ìŠ¤í”„ë§ ë°°ì¹˜ í”„ë¡œì íŠ¸ë“¤ì˜ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ìˆëŠ” ë„ì»¤íŒŒì¼ì„ í™œìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- 3ê°œì˜ ì»¨í…Œì´ë„ˆ ë„ì›Œì§„ ê²ƒì„ í™•ì¸ í›„ api, batch, react compose íŒŒì¼ì˜ ë³€ìˆ˜ ì„¤ì •ì„ ë§ˆì¹œ ì´í›„ compose ì‹¤í–‰
- batch ì»¨í…Œì´ë„ˆ ë„ìš°ê¸° ì „ selenium í¬ë¡¤ë§ì„ ìœ„í•´ ë„ì»¤íŒŒì¼ì—ì„œ ì„¤ì¹˜ëœ chrome ë²„ì „ì„ í™•ì¸í•˜ê³  í•´ë‹¹ ë²„ì „ì— ë§ê²Œ í¬ë¡¬ ë“œë¼ì´ë²„ ì„¤ì¹˜ ì´í›„ batch ì»¨í…Œì´ë„ˆì— ë³¼ë¥¨ì„¤ì •

# ğŸ“˜ ì‹¤í–‰ ë°©ë²•

https://aka.ms/vscode-workspace-trust

## dockerë¥¼ í™œìš©í•œ ì‹¤í–‰ ê°€ì´ë“œ

### 1. **git clone**

```bash
wget https://chromedriver.storage.googleapis.com/118.0.5993.89/chromedriver_linux64.zip
ì••ì¶• í•´ì œ ë° ì„¤ì¹˜:
bash
ì½”ë“œ ë³µì‚¬
unzip chromedriver_linux64.zip

```

### 2. **[ë„ì»¤ ì„¤ì¹˜](https://docs.docker.com/get-docker/) ë° ë„ì»¤ [ì»´í¬ì¦ˆ ì„¤ì¹˜](https://docs.docker.com/compose/install/)**

### 3. **Dockerfile ë° docker-compose.ymlì‘ì„±**

- nginx Dockerfile

  ```docker
   FROM node:16.17.0 as builder
   # ì‘ì—… í´ë”ë¡œ ì†ŒìŠ¤ íŒŒì¼ ë³µì‚¬
   COPY {git í´ë”}/front/sharkshark /home/react
   WORKDIR /home/react
   # node íŒ¨í‚¤ì§€ ì„¤ì¹˜ í›„ ë¹Œë“œ
   RUN npm install
   RUN npm run build

   FROM nginx
   # nginx ì„¤ì • ë³µì‚¬
   COPY {nginx.conf ìœ„ì¹˜} /etc/nginx
   # ë¹Œë“œ íŒŒì¼ ë³µì‚¬
   COPY --from=builder /home/react/build /home/build
   # í¬íŠ¸ ê°œë°©
   EXPOSE 80
   CMD ["nginx", "-g", "daemon off;"]
  ```

- fastapi dockerfile

  ```docker
   FROM python:3.9
   # ì‘ì—… í´ë”ë¡œ ì‹¤í–‰ í´ë” ë³µì‚¬
   WORKDIR /code
   COPY {git í´ë”}/back/pythonProject /code
   # íŒŒì´ì¬ íŒ¨í‚¤ì§€ ì„¤ì¹˜ í›„ ì‹¤í–‰
   RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt
   CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
  ```

- nginx.conf íŒŒì¼

  ```bash
   user nginx;
   worker_processes auto;
   events {
     worker_connections 1024;
   }
   http{
     include mime.types;
     access_log /var/log/nginx/access.log;
     error_log /var/log/nginx/error.log;

     server {
       // í¬íŠ¸ ì§€ì •
       listen 80;
       listen [::]:80;

       // í”„ë¡ íŠ¸ ë¹Œë“œíŒŒì¼ ê²½ë¡œì„¤ì •
       location / {
         root	/home/build;
         index	index.html index.htm;
         try_files 	$uri $uri/ /index.html;
       }
       // ë°±ì—”ë“œ api ìš”ì²­ í¬ì›Œë”©
       location /api/{
         proxy_pass http://172.17.0.1:8000/;
       }
     }
   }
  ```

- docker-compose.yml

  ```yml
  version: "3"
  services:
    nginx:
      build:
        context: .
        dockerfile: { nginx dockerfile ì´ë¦„ }
      ports:
        - 80:80
    api:
      build:
        context: .
        dockerfile: { fastapi dockerfile ì´ë¦„ }
      ports:
        - 8000:8000
      extra_hosts:
        - "localhost:host-gateway"
  ```

### 4. **ë„ì»¤ ì»¨í…Œì´ë„ˆ ì‹¤í–‰**

- mysql ì´ë¯¸ì§€ ì‹¤í–‰í•˜ê¸°

  ```bash
   # mysql ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°
   docker pull mysql

   # ì»¨í…Œì´ë„ˆ ì‹¤í–‰
   docker run --name mysql -e MYSQL_ROOT_PASSWORD={password} -d -p 3306:3306 mysql
  ```

- 3306í¬íŠ¸ë¡œ mySQL ì ‘ì†í•˜ì—¬ b205 ìŠ¤í‚¤ë§ˆ ìƒì„±

- docker-compose ì‹¤í–‰

  ```bash
  docker compose up -d --build
  # í˜¹ì€
  docker-compose up -d --build
  ```

### 5. **ì‘ë™ í™•ì¸**

- ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ì¡°íšŒ

  ```bash
  docker ps
  ```

- mySQL ì ‘ì†í•˜ì—¬ DB [ë¤í”„ íŒŒì¼](/exec/sharkshark_dp_dump.zip) ì‹¤í–‰

---

ì‘ì„±: ì´ì°½í˜„
